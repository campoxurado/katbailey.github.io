<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title>Matrix Factorization</title><meta name="generator" content="Hovercraft! 1.0 http://regebro.github.com/hovercraft"></meta><link rel="stylesheet" href="css/hovercraft.css" media="all"></link><link rel="stylesheet" href="css/impressConsole.css" media="all"></link><link rel="stylesheet" href="css/highlight.css" media="all"></link><link rel="stylesheet" href="mf.css" media="screen,projection"></link></head><body class="impress-not-supported"><div id="impress"><div class="step step-level-1" step="0" id="title" data-x="-1200" data-y="0" data-z="0" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1"><h1 id="matrix-factorization-for-content-recommendations">Matrix Factorization for Content Recommendations</h1><p>with TensorFlow</p></div><div class="step step-level-1" step="1" id="netflix-problems" data-x="0" data-y="0" data-z="0" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1"><h1 id="first-world-netflix-problems">First world Netflix problems...</h1><img src="images/netflix-problems.jpeg"></img></div><div class="step step-level-1" step="2" id="content-collaborative" data-x="0" data-y="800" data-z="0" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1"><h1 id="content-filtering">Content Filtering</h1><p>vs</p><h1 id="collaborative-filtering">Collaborative Filtering</h1></div><div class="step step-level-1" step="3" id="content" data-x="-1000" data-z="-1000" data-y="1800" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1"><h1 id="id1">Content Filtering</h1><img src="images/pandora1.jpg"></img></div><div class="step step-level-1" step="4" id="content-collaborative-1" data-x="0" data-y="800" data-z="0" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1"><h1 id="id2">Content Filtering</h1><p>vs</p><h1 id="id3">Collaborative Filtering</h1></div><div class="step step-level-1" step="5" data-x="1000" data-z="-1000" data-y="1800" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1"><h1 id="id4">Collaborative Filtering</h1><p>Use past user behavior to predict future preferences. "Collaborative" because users collaborate to fill in the gaps.</p></div><div class="step step-level-1" step="6" id="neighborhood-latent" data-x="1000" data-z="-1000" data-y="3000" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1"><h1 id="neighborhood-methods">Neighborhood methods</h1><p>vs</p><h1 id="latent-factor-models">Latent factor models</h1></div><div class="step step-level-1" step="7" id="neighborhood" data-y="3800" data-x="400" data-z="-1400" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1"><h1 id="id5">Neighborhood methods</h1><p>Recommend based on <em>similarity</em> of users.</p><p>E.g. if Bob has rated items x, y and z highly, find other users who have rated those items highly and see what else they like, then recommend to Bob those with the most agreement among the other users.</p></div><div class="step step-level-1" step="8" id="neighborhood-1" data-rotate-y="90" data-x="-400" data-y="3800" data-z="-1800" data-rotate-x="0" data-rotate-z="0" data-scale="1"><img src="images/collaborative_filtering.png"></img><p>(<a href="https://unsupervised.blogs.balabit.com/2015/07/recommender-systems-in-anomaly-detection/">Image source</a>)</p></div><div class="step step-level-1" step="9" id="neighborhood-latent-1" data-rotate-y="0" data-x="1000" data-y="3000" data-z="-1000" data-rotate-x="0" data-rotate-z="0" data-scale="1"><h1 id="id6">Neighborhood methods</h1><p>vs</p><h1 id="id7">Latent factor models</h1></div><div class="step step-level-1" step="10" id="latent-factor" data-x="1800" data-y="3800" data-z="-1400" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1"><h1 id="id8">Latent factor models</h1><p>Learn hidden features in items and users that interact in such a way as to produce the ratings we've seen.</p></div><div class="step step-level-1" step="11" id="sparse-matrix" data-x="1800" data-y="4800" data-z="-1400" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1"><h1 id="ratings-matrices-are-sparse">Ratings matrices are sparse</h1><img src="images/sparse_matrix_sm.png"></img></div><div class="step step-level-1" step="12" id="matrix-factorization" data-x="2800" data-y="4800" data-z="-1400" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1"><h1 id="matrix-factorization">Matrix Factorization</h1><img src="images/factors.png"></img></div><div class="step step-level-1" step="13" id="matrix-factorization-1" data-x="2800" data-y="4800" data-z="-1400" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1"><h1 id="id9">Matrix Factorization</h1><img src="images/factors2.png"></img></div><div class="step step-level-1" step="14" id="r-hat" data-x="2800" data-y="4800" data-z="-1400" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1"><h1 id="id10">Matrix Factorization</h1><img src="images/rhat.png"></img></div><div class="step step-level-1" step="15" id="tensorflow" data-x="1800" data-y="5800" data-z="-1400" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1"><img src="images/tensorflow.png"></img></div><div class="step step-level-1" step="16" id="tensorflow-why" data-x="2800" data-y="5800" data-z="-1400" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1"><h1 id="why-use-tensorflow">Why use TensorFlow?</h1><ul><li>TF is for computations on Tensors, i.e. multi-dimensional arrays</li><li>Tensors can be composed of learnable variables and constants</li><li>Learn using Gradient Descent</li><li>Perfect for the matrix factorization problem!</li></ul></div><div class="step step-level-1" step="17" id="tensorflow-how" data-x="3800" data-y="5800" data-z="-1400" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1"><h1 id="how">How?</h1></div><div class="step step-level-1" step="18" id="tensorflow-1" data-x="4800" data-y="5800" data-z="-1400" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1"><h1 id="sparse-representation">Sparse representation</h1><img src="images/coo.png"></img></div><div class="step step-level-1" step="19" id="tensorflow-factors" data-x="5800" data-y="5800" data-z="-1400" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1"><h1 id="create-factors">Create factors</h1><img src="images/tensorflow_learn_1.png"></img></div><div class="step step-level-1" step="20" id="tensorflow-factors-1" data-x="5800" data-y="5800" data-z="-1400" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1"><h1 id="id11">Create factors</h1><img src="images/tensorflow_learn_2.png"></img></div><div class="step step-level-1" step="21" id="tensorflow-extract" data-x="6800" data-y="5800" data-z="-1400" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1"><h1 id="extract-result">Extract result</h1><img src="images/tensorflow_learn_3.png"></img></div><div class="step step-level-1" step="22" id="tensorflow-cost" data-x="7800" data-y="5800" data-z="-1400" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1"><h1 id="calculate-cost">Calculate cost</h1><img src="images/cost.png"></img></div><div class="step step-level-1" step="23" id="regularization" data-x="8800" data-y="5800" data-z="-1400" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1"><h1 id="regularization">Regularization</h1><p>Shrink the learned factor values by adding the sum of their squares times some lambda parameter to the base cost.</p></div><div class="step step-level-1" step="24" id="bias" data-x="1800" data-y="6800" data-z="-1400" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1"><h1 id="what-about-mean-and-bias">What about mean and bias?</h1></div><div class="step step-level-1" step="25" id="bias-1" data-x="2800" data-y="6800" data-z="-1400" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1"><img src="images/bias.png"></img></div><div class="step step-level-1" step="26" id="add-mean" data-x="3800" data-y="6800" data-z="-1400" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1"><h1 id="global-mean">Global mean</h1><p>The mean rating can be added on to the multiplication result at the end (before calculating cost) - or the data can be centered by subtracting the mean before training (and evaluating against the centered ratings.)</p></div><div class="step step-level-1" step="27" id="user-bias" data-x="4800" data-y="6800" data-z="-1400" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1"><h1 id="learning-user-bias">Learning user bias</h1><img src="images/learn_user_bias.png"></img></div><div class="step step-level-1" step="28" id="item-bias" data-x="5800" data-y="6800" data-z="-1400" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1"><h1 id="learning-item-bias">Learning item bias</h1><p>with user bias held fixed</p><img src="images/learn_item_bias_on_user.png"></img></div><div class="step step-level-1" step="29" id="all-together" data-x="6800" data-y="6800" data-z="-1400" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1"><h1 id="putting-it-together">Putting it together</h1><img src="images/equation.png"></img></div><div class="step step-level-1" step="30" id="learnable" data-x="7800" data-y="6800" data-z="-1400" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1"><h1 id="tensors-with-different-learnable-components">Tensors with different learnable components</h1><img src="images/all_tensors.png"></img></div><div class="step step-level-1" step="31" id="can-haz-code" data-x="8800" data-y="6800" data-z="-1400" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1"><h1 id="can-haz-code">Can haz code?</h1><ul><li>Factorizer on <a href="https://github.com/katbailey/factorizer">github</a></li><li><a href="https://pub.beakernotebook.com/#/publications/2193c148-0cca-11e6-a0fe-876badf1ddf3">Beaker notebook</a></li></ul></div><div class="step step-level-1" step="32" id="next-steps" data-x="0" data-y="-1200" data-z="0" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1"><h1 id="next-steps">Next Steps</h1><ul><li>Try with regularization param that's linear in number of observations</li><li>Try adding movie genre to the mix</li></ul></div><div class="step step-level-1" step="33" id="random-stuff" data-x="1200" data-y="-1200" data-z="0" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1"><h1 id="random-stuff">Random Stuff</h1><ul><li>Always be benchmarking</li><li>Cloud computing and the screen command are your friends<ul><li>Google Cloud Platform vs Amazon AWS</li></ul></li></ul></div><div class="step step-level-1" step="34" id="gcp" data-x="2400" data-y="-1200" data-z="0" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1"><img src="images/gcp_sm.png"></img></div><div class="step step-level-1" step="35" id="resources" data-x="3600" data-y="-1200" data-z="0" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0" data-scale="1"><h1 id="resources">Resources</h1><ul><li>TensorFlow <a href="https://www.tensorflow.org/versions/r0.8/get_started/index.html">Documentation</a></li><li>Josh's TensorFlow <a href="http://jrmeyer.github.io/tutorial/2016/02/01/TensorFlow-Tutorial.html">blog post</a></li><li>RStudio post on <a href="https://blog.rstudio.org/2016/03/29/feather/">Feather file format</a></li><li><a href="http://beakernotebook.com/">Beaker notebooks</a></li><li>Paper on <a href="https://datajobs.com/data-science-repo/Recommender-Systems-%5BNetflix%5D.pdf">Matrix Factorization Techniques for Recommender Systems</a></li><li>Book on <a href="http://arek-paterek.com/book/">Predicting movie ratings and recommender systems</a></li></ul></div><div class="step step-level-1" step="36" id="final" data-x="-1000" data-y="2500" data-z="2000" data-scale="7" data-rotate-x="0" data-rotate-y="0" data-rotate-z="0"><h1 id="questions">Questions? :)</h1></div></div><div id="hovercraft-help"><table><tr><th>Space</th><td>Forward</td></tr><tr><th>Right, Down, Page Down</th><td>Next slide</td></tr><tr><th>Left, Up, Page Up</th><td>Previous slide</td></tr><tr><th>P</th><td>Open presenter console</td></tr><tr><th>H</th><td>Toggle this help</td></tr></table></div><script type="text/javascript" src="js/impress.js"></script><script type="text/javascript" src="js/impressConsole.js"></script><script type="text/javascript" src="js/hovercraft.js"></script></body></html>